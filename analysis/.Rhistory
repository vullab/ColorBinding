legend.position = 'right',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
labs(title = 'Probability of colors coming from same object, given they came from an adjacent object',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(same object) +/- sem',
x = NULL)
data.lineplot  %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=partMatch))+
facet_grid(experiment ~ .)+
geom_hline(yintercept = 0.5, color='gray')+
geom_point(data = filter(data.lineplot, sig),
aes(x = description,
y = mean.p),
size=4, color='black')+
geom_pointrange(size=0.3)+
# geom_line() +
scale_color_manual(values=c('correct'='blue',
'repeated'='gray',
'swapped'='red',
'error' = 'orange'))+
theme_minimal()+
theme(strip.text = element_text(face='bold'),
panel.grid.major.x = element_blank(),
legend.position = 'right',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
labs(title = 'Probability of colors coming from same object, given they came from an adjacent object',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(same object) +/- sem',
x = NULL)
data.lineplot  %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=partMatch))+
facet_grid(experiment ~ .)+
geom_hline(yintercept = 0.5, color='gray')+
geom_point(data = filter(data.lineplot, sig),
aes(x = description,
y = mean.p),
size=5, color='black')+
geom_pointrange(size=0.3)+
# geom_line() +
scale_color_manual(values=c('correct'='blue',
'repeated'='gray',
'swapped'='red',
'error' = 'orange'))+
theme_minimal()+
theme(strip.text = element_text(face='bold'),
panel.grid.major.x = element_blank(),
legend.position = 'right',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
labs(title = 'Probability of colors coming from same object, given they came from an adjacent object',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(same object) +/- sem',
x = NULL)
data.lineplot  %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=partMatch))+
facet_grid(experiment ~ .)+
geom_hline(yintercept = 0.5, color='gray')+
geom_point(data = filter(data.lineplot, sig),
aes(x = description,
y = mean.p),
size=3, color='black')+
geom_pointrange(size=0.3)+
# geom_line() +
scale_color_manual(values=c('correct'='blue',
'repeated'='gray',
'swapped'='red',
'error' = 'orange'))+
theme_minimal()+
theme(strip.text = element_text(face='bold'),
panel.grid.major.x = element_blank(),
legend.position = 'right',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
labs(title = 'Probability of colors coming from same object, given they came from an adjacent object',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(same object) +/- sem',
x = NULL)
data.lineplot  %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=partMatch))+
facet_grid(experiment ~ .)+
geom_hline(yintercept = 0.5, color='gray')+
geom_point(data = filter(data.lineplot, sig),
aes(x = description,
y = mean.p),
size=3, color='black')+
geom_pointrange(size=0.3)+
# geom_line() +
scale_color_manual(values=c('correct'='blue',
'repeated'='gray',
'swapped'='red',
'error' = 'orange'))+
theme_minimal()+
theme(strip.text = element_text(face='bold'),
panel.grid.major.x = element_blank(),
legend.position = 'top',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
labs(title = 'Probability of colors coming from same object, given they came from an adjacent object',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(same object) +/- sem',
x = NULL)
data.lineplot  %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=partMatch))+
facet_grid(experiment ~ .)+
geom_hline(yintercept = 0.5, color='gray')+
geom_point(data = filter(data.lineplot, sig),
aes(x = description,
y = mean.p),
size=3, color='black')+
geom_pointrange(size=0.3)+
# geom_line() +
scale_color_manual(values=c('correct'='blue',
'repeated'='gray',
'swapped'='red',
'error' = 'orange'))+
theme_minimal()+
theme(strip.text = element_text(face='bold'),
panel.grid.major.x = element_blank(),
legend.position = 'top',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
labs(title = 'Probability of colors coming from same object, given they came from an adjacent object',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(same object) +/- sem',
x = NULL)+
guides(color=guide_legend(title='Part-matched'))
data.lineplot  %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=partMatch))+
facet_grid(experiment ~ .)+
geom_hline(yintercept = 0.5, color='gray')+
geom_point(data = filter(data.lineplot, sig),
aes(x = description,
y = mean.p),
size=3, color='black')+
geom_pointrange(size=0.3)+
# geom_line() +
scale_color_manual(values=c('correct'='blue',
'repeated'='gray',
'swapped'='red',
'error' = 'orange'))+
theme_minimal()+
theme(strip.text = element_text(face='bold'),
panel.grid.major.x = element_blank(),
legend.position = 'top',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
guides(color=guide_legend(title='Part-matched'))+
labs(title = 'Probability of colors coming from same object, given they came from an adjacent object',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(same object) +/- sem',
x = NULL)+
guides(color=guide_legend(title='Part-matched'))
data.lineplot  %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=partMatch))+
facet_grid(experiment ~ .)+
geom_hline(yintercept = 0.5, color='gray')+
geom_point(data = filter(data.lineplot, sig),
aes(x = description,
y = mean.p),
size=3, color='black')+
geom_pointrange(size=0.3)+
# geom_line() +
scale_color_manual(values=c('correct'='blue',
'repeated'='gray',
'swapped'='red',
'error' = 'orange'))+
theme_minimal()+
theme(strip.text = element_text(face='bold'),
panel.grid.major.x = element_blank(),
legend.position = 'top',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
guides(color=guide_legend(title='Part-matched'))+
labs(title = 'Probability of colors coming from same object, given they came from an adjacent object',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(same object) + 95% c.i.',
x = NULL)+
guides(color=guide_legend(title='Part-matched'))
data.lineplot  %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=partMatch))+
facet_grid(experiment ~ .)+
geom_hline(yintercept = 0.5, color='gray')+
geom_point(data = filter(data.lineplot, sig),
aes(x = description,
y = mean.p),
size=3, color='black')+
geom_pointrange(size=0.3)+
# geom_line() +
scale_color_manual(values=c('correct'='blue',
'repeated'='gray',
'swapped'='red',
'error' = 'orange'))+
theme_minimal()+
theme(strip.text = element_text(face='bold'),
panel.grid.major.x = element_blank(),
legend.position = 'top',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
guides(color=guide_legend(title='Part-matched'))+
labs(title = 'Probability of colors coming from same object, given they came from an adjacent object',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(same object) + 95% CI',
x = NULL)+
guides(color=guide_legend(title='Part-matched'))
data.lineplot  %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=partMatch))+
facet_grid(experiment ~ .)+
geom_hline(yintercept = 0.5, color='gray')+
geom_point(data = filter(data.lineplot, sig),
aes(x = description,
y = mean.p),
size=3, color='black')+
geom_pointrange(size=0.3)+
# geom_line() +
scale_color_manual(values=c('correct'='blue',
'repeated'='gray',
'swapped'='red',
'error' = 'orange'))+
theme_minimal()+
theme(strip.text = element_text(face='bold'),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_blank(),
legend.position = 'top',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
guides(color=guide_legend(title='Part-matched'))+
labs(title = 'Probability of colors coming from same object, given they came from an adjacent object',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(same object) + 95% CI',
x = NULL)+
guides(color=guide_legend(title='Part-matched'))
data.lineplot  %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=partMatch))+
facet_grid(experiment ~ .)+
geom_hline(yintercept = 0.5, color='gray')+
geom_point(data = filter(data.lineplot, sig),
aes(x = description,
y = mean.p),
size=3, color='black')+
geom_pointrange(size=0.3)+
# geom_line() +
scale_color_manual(values=c('correct'='blue',
'repeated'='gray',
'swapped'='red',
'error' = 'orange'))+
theme_minimal()+
theme(strip.text = element_text(face='bold'),
panel.grid.major.x = element_blank(),
legend.position = 'top',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
guides(color=guide_legend(title='Part-matched'))+
labs(title = 'Probability of colors coming from same object, given they came from an adjacent object',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(same object) + 95% CI',
x = NULL)+
guides(color=guide_legend(title='Part-matched'))
t.crit = function(conf.level, df){
alpha = 1-conf.level
qt(1-alpha/2, df)
}
data.lineplot = data.counts %>%
filter(version %in% version.include) %>%
mutate(sameErr = abs(resp.h.pos) == abs(resp.v.pos),
erMag = abs(resp.h.pos),
sameObj= resp.h.pos == resp.v.pos,
pos = resp.h.pos,
partMatch = case_when(
resp.h.hv == 1 & resp.v.hv == 2 ~ 'correct',
resp.h.hv == 2 & resp.v.hv == 1 ~ 'swapped',
resp.h.hv == resp.v.hv ~ 'repeated',
TRUE ~ 'error')) %>%
group_by(experiment, subjectID, version) %>%
filter(sameObj,
sameErr,
partMatch %in% c('correct','swapped')) %>%
group_by(subjectID, experiment, version, pos) %>%
summarize(p.binding = n[partMatch=='correct']/sum(n[partMatch %in% c('correct','swapped')]),
n = sum(n[partMatch %in% c('correct','swapped')])) %>%
filter(n>0) %>%
group_by(experiment, version, pos) %>%
summarise(mean.p.binding = mean(p.binding),
se.p.binding = sd(p.binding)/sqrt(n()),
t = t.crit(0.95, n()-1)) %>%
mutate(description = (factor(version.code[as.character(version)],
levels = version.order))) %>%
mutate(sig = (mean.p.binding-0.5)>(t*se.p.binding))
data.lineplot  %>%
ggplot(aes(x = pos,
y = mean.p.binding,
ymin = mean.p.binding-se.p.binding,
ymax=mean.p.binding+se.p.binding,
color=experiment))+
facet_grid(.~description)+
geom_hline(yintercept = 0.5, color='gray') +
geom_pointrange(size=0.3)+
geom_line() +
theme_minimal()+
theme(strip.text = element_text(face='bold'),
legend.position = 'right',
panel.grid.minor = element_blank())+
labs(title = 'Probability of correct part binding',
subtitle = 'showing only same source object',
y = 'p(correct part binding)',
x = 'source object position (0=target)')
data.lineplot <- data.counts %>%
filter(version %in% version.include) %>%
mutate(sameErr = abs(resp.h.pos) == abs(resp.v.pos),
erMag = abs(resp.h.pos),
sameObj= resp.h.pos == resp.v.pos,
pos = resp.h.pos,
partMatch = case_when(
resp.h.hv == 1 & resp.v.hv == 2 ~ 'correct',
resp.h.hv == 2 & resp.v.hv == 1 ~ 'swapped',
resp.h.hv == resp.v.hv ~ 'repeated',
TRUE ~ 'error')) %>%
filter(!sameObj,
sameErr,
partMatch != 'repeated') %>%
group_by(subjectID, experiment, version, partMatch, erMag) %>%
summarise(n=sum(n)) %>%
ungroup() %>%
group_by(subjectID, experiment, version, erMag) %>%
summarise(p.bound = n[partMatch=='correct']/sum(n),
n = sum(n)) %>%
ungroup() %>%
filter(n>0) %>%
group_by(experiment, version, erMag) %>%
summarise(mean.p = mean(p.bound),
sem.p = sd(p.bound)/sqrt(n()),
t = t.crit(0.95, n()-1)) %>%
mutate(description = (factor(version.code[as.character(version)],
levels = version.order)))%>%
filter(erMag==1) %>%
mutate(sig = (mean.p-0.5)>(t*sem.p))
data.lineplot   %>%
ggplot(aes(x = experiment,
y = mean.p,
ymin = mean.p-sem.p,
ymax=mean.p+sem.p,
color=experiment))+
facet_grid(. ~ description)+
# geom_label(data=version.summary %>% filter(version %in% version.include),
#            aes(x=0,y=-4, label=paste0('n=',subjects),
#                ymin=NULL,ymax=NULL,color=NULL),
#            size=3)+
geom_hline(yintercept = 0.5)+
geom_pointrange(size=0.3)+
geom_line() +
theme_minimal()+
theme(strip.text = element_text(face='bold'),
legend.position = 'top',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
labs(title = 'Probability of reported colors',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(bound) +/- 1 sem',
x = NULL)
data.lineplot   %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-sem.p,
ymax=mean.p+sem.p))+
facet_grid(experiment ~ .)+
# geom_label(data=version.summary %>% filter(version %in% version.include),
#            aes(x=0,y=-4, label=paste0('n=',subjects),
#                ymin=NULL,ymax=NULL,color=NULL),
#            size=3)+
geom_hline(yintercept = 0.5)+
geom_pointrange(size=0.3)+
geom_line() +
theme_minimal()+
theme(strip.text = element_text(face='bold'),
legend.position = 'top',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
labs(title = 'Probability of reported colors',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(bound) +/- 1 sem',
x = NULL)
data.lineplot   %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=sig))+
facet_grid(experiment ~ .)+
# geom_label(data=version.summary %>% filter(version %in% version.include),
#            aes(x=0,y=-4, label=paste0('n=',subjects),
#                ymin=NULL,ymax=NULL,color=NULL),
#            size=3)+
geom_hline(yintercept = 0.5)+
geom_pointrange(size=0.3)+
geom_line() +
theme_minimal()+
theme(strip.text = element_text(face='bold'),
legend.position = 'top',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
labs(title = 'Probability of reported colors',
subtitle = 'normalized after removing repetitions; showing only same source object',
y = 'mean p(bound) +/- 1 sem',
x = NULL)
data.lineplot   %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=!sig))+
facet_grid(experiment ~ .)+
# geom_label(data=version.summary %>% filter(version %in% version.include),
#            aes(x=0,y=-4, label=paste0('n=',subjects),
#                ymin=NULL,ymax=NULL,color=NULL),
#            size=3)+
geom_hline(yintercept = 0.5)+
geom_pointrange(size=0.3)+
geom_line() +
theme_minimal()+
theme(strip.text = element_text(face='bold'),
legend.position = 'top',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
labs(y = 'mean p(part-match) + 95% CI',
x = NULL)
data.lineplot   %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=sig))+
facet_grid(experiment ~ .)+
# geom_label(data=version.summary %>% filter(version %in% version.include),
#            aes(x=0,y=-4, label=paste0('n=',subjects),
#                ymin=NULL,ymax=NULL,color=NULL),
#            size=3)+
scale_color_manual(values = c('TRUE' = 'black', 'FALSE'='gray'))+
geom_hline(yintercept = 0.5)+
geom_pointrange(size=0.3)+
geom_line() +
theme_minimal()+
theme(strip.text = element_text(face='bold'),
legend.position = 'top',
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
labs(y = 'mean p(part-match) + 95% CI',
x = NULL)
source('~/PROJECTS/multicolor-binding/github/analysis/lineplots.diff-obj.pbound.R')
data.lineplot   %>%
ggplot(aes(x = description,
y = mean.p,
ymin = mean.p-t*sem.p,
ymax=mean.p+t*sem.p,
color=sig))+
facet_grid(experiment ~ .)+
# geom_label(data=version.summary %>% filter(version %in% version.include),
#            aes(x=0,y=-4, label=paste0('n=',subjects),
#                ymin=NULL,ymax=NULL,color=NULL),
#            size=3)+
scale_color_manual(values = c('TRUE' = 'black', 'FALSE'='gray'))+
geom_hline(yintercept = 0.5)+
geom_pointrange(size=0.3)+
geom_line() +
theme_minimal()+
theme(strip.text = element_text(face='bold'),
legend.position = 'top',
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, hjust=1, vjust=0.5))+
labs(y = 'mean p(part-match) + 95% CI',
x = NULL)
